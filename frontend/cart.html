<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <title>Add To Cart</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="icon" href="images/favicon.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0,user-scalable=no">
    <link rel="stylesheet" href="css/bootstrap.min.css" />
    <link rel="stylesheet" href="css/fontawesome.min.css">
    <link rel="stylesheet" href="css/font-awesome.css">
    <link rel="stylesheet" href="css/owl.carousel.min.css">
    <link rel="stylesheet" href="css/jquery.fancybox.min.css">
    <link rel="stylesheet" href="css/style.css" />
    <link rel="stylesheet" href="css/responsive.css" />
    <link rel="stylesheet" href="css/slick.css" />



</head>

<body>
    <header>
        <div class="mobile-menu">
            <div class="circle" id="navbar"><i class="fa fa-bars" aria-hidden="true"></i></div>
            <div class="nveMenu text-left">
                <div class="mobile-cross close-btn-nav" id="navbar"><i class="fas fa-times" aria-hidden="true"></i>
                </div>
                <div>
                    <a href="index.html"><img src="images\logo.png" class="img-fluid"></a>
                </div>
                <ul class="navlinks p-0 mt-4">
                    <li><a href="index.html">Home</a></li>
                    <li><a href="product.html">Shop</a></li>
                    <li><a href="about.html">About Us</a></li>
                    <li><a href="contact.html">Contact Us</a></li>

                    <img src="images/bucket.png" alt="">
                    <sup>2</sup>
                    </li>
                    <li>
                        <img src="images/heart.png" alt="">
                        <sup>2</sup>
                    </li>
                    <li><a href="#">Login </a></li>
                </ul>
            </div>
            <div class="overlay"></div>
        </div>
        <div class="main-nav inner-main-nav">
            <div class="container">
                <div class="row">
                    <div class="col-lg-3">
                        <div class="logo">
                            <a href="index.html"><img src="images/logo.png" alt=""></a>
                        </div>
                    </div>
                    <div class="col-lg-5">
                        <ul>
                            <li><a href="index.html">Home</a></li>
                            <li><a href="product.html">Shop</a></li>
                            <li><a href="about.html">About Us</a></li>
                            <li><a href="contact.html">Contact Us</a></li>
                        </ul>
                    </div>
                    <div class="col-lg-4">
                        <ul>
                            <li>
                                <div id="google_translate_element">

                                </div>
                                <script type="text/javascript" src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
                            </li>
                            <li>
                                <a href="cart.html">
                                    <img src="images/bucket.png" alt="">
                                    <sup>2</sup>
                                </a>
                            </li>
                            <li>
                                <img src="images/heart.png" alt="">
                                <sup>2</sup>
                            </li>
                            <li class="user-login">
                                <a href="signin.html"><img src="images/user-login.png" /> </a>
                            </li>
                        </ul>


                    </div>
                </div>
            </div>
        </div>
    </header>
    <section class="bredcrump-banner">
        <div class="container">
            <div class="breadcrump">
                <ul>
                    <li>
                        <a href="index.html"><img src="images/home-icon.png" alt=""></a>
                    </li>
                    <li><span>/</span>
                        <a href="#!"></a>Add To Cart</li>
                </ul>
            </div>
        </div>
    </section>

    <section class="cart-sec">
        <div class="container">
            <div class="review-order-form">
                <ul>
                    <li><a href="cart.html" class="active"><span><img src="images/t-active.png" alt=""></span><h4>Review Order</h4></a></li>
                    <li><a href="shipping.html"><span><img src="images/t-active1.png" alt=""></span><h4>Add Details</h4></a></li>
                    <li><a href="checkout.html"><span><img src="images/t-active1.png" alt=""></span><h4>Checkout</h4></a></li>
                    <li><a href="order-cancel.html"><span><img src="images/t-active1.png" alt=""></span><h4>Order Cancelation</h4></a></li>
                </ul>
            </div>
        </div>
    </section>
    </section>
    <section class="add-to-cart">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-md-12 col-12">
                    <div class="cart-content">
                        <ul class="cart1">
                            <li>
                                <h3>Cart</h3>
                                <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod.</p>
                            </li>
                            <li>
                                <!-- <form action="http://localhost/odooo/backend/api/clearCart.php" method="post"> -->

                                <button value="Remove" id="deleteButton" name="remove_cart">
                                <img src="images/delete.svg" alt="">
                                
                                </button>

                                <!-- </form> -->
                            </li>
                        </ul>
                        <table class="cart-table">
                            <thead>
                                <tr>
                                    <th colspan="1" style="width: 430px;">
                                        <input type="checkbox" name="" id="">
                                        <h3>Product</h3>
                                    </th>

                                    <th colsapn="2">
                                        <h3>Quantity</h3>
                                    </th>

                                    <th>
                                        <h3>Price</h3>
                                    </th>
                                </tr>
                            </thead>
                            <tbody id="cartContainer">
                                <!-- <tr>
                                <td class="row">
                                    <div class="left col-lg-3 col-md-3 col-3">
                                    <input type="checkbox" name="" id="">
                                    <img src="images/cart-product-1.png" alt="" class="img-fluid">
                                    </div>
                                    <div class="right col-lg-6 col-md-9 col-7">
                                        <h4>La Mesilla - Guatemala Coffee – Filter</h4>
                                        <span>250kg</span>
                                    </div>
                                </td>
                                <td>
                                    <input type="number" class="quantity" value="1">
                                </td>
                                <td>
                                    <h4>170.50 SR</h4>
                                </td>
                            </tr> -->
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="col-lg-4 col-md-12 col-12">
                    <div class="process">
                        <ul>
                            <li>
                                <h4>SubTotal <span></span></h4>
                                <h3 id="subTotal"></h3>
                            </li>
                            <li>
                                <h4>Discount</h4>
                                <h3 id="discount">0 SR</h3>
                            </li>
                        </ul>
                        <ul>
                            <li>
                                <h4>Grand Total</h4>
                                <h3 id="grandTotal"></h3>
                            </li>


                        </ul>
                        <button><a href="checkout.html">Process To Shipping</a></button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="portal-ftr-top">
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <div class="portal-ftr-cirle">
                        <img src="images/circle-more.png">
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="portal-ftr-right">
                        <img src="images/logo-black.png">
                    </div>
                </div>
            </div>
        </div>
    </section>
    <footer class="contact-detail">
        <div class="copyright">
            <p>© 2023 AQAHI. All rights reserved. </p>
        </div>
    </footer>
    <script>
        function del(cartId, productIds) {
            // const rawResponse = fetch(
            //     "http://localhost/odooo/backend/api/clearCart.php", {
            //         method: "POST",
            //         headers: {
            //             Accept: "application/json",
            //             "Content-Type": "application/json",
            //         },
            //         body: JSON.stringify({
            //             cartid: cartId,
            //             productid: productIds
            //         }),
            //     }
            // );

            // const body = JSON.stringify({
            //     cartid: cartId,
            //     productid: productIds
            // });
            // console.log(body);
            // const content = rawResponse;

            // console.log(content);
            const requestOptions = {
                method: "POST",
                headers: {
                    Accept: "application/json",
                    "Content-Type": "application/json",
                },
                body: JSON.stringify({
                    cartid: cartId,
                    productid: productIds,
                }),
            };

            fetch("http://localhost/odooo/backend/api/clearCart.php", requestOptions)
                .then((response) => {
                    if (!response.ok) {
                        throw new Error("Network response was not ok");
                    }
                    return response.json(); // Parse JSON response
                })
                .then((data) => {
                    getCartContent();
                    console.log("Response data:", data);
                })
                .catch((error) => {
                    console.error("Error:", error);
                });
        }
        const productIds = [];
        let cartId;

        function getCartContent() {
            const url_product = "http://localhost/odooo/backend/api/getCartContent.php";

            fetch(url_product)
                .then((response) => {
                    if (!response.ok) {
                        throw new Error("Network response was not ok");
                    }
                    return response.json();
                })
                .then((data) => {
                    console.log(data);
                    // Add items to the list one by one

                    let products = data;
                    let cartContainer = document.getElementById("cartContainer");
                    cartContainer.innerHTML = '';
                    console.log(products);
                    let subTotal = 0;
                    // Assuming newdata is an array you want to iterate over
                    products.forEach(function(data) {
                        var cartHTML = `<tr>
                        <td class="row">
                            <div class="left col-lg-3 col-md-3 col-3">
                                <input type="hidden" name="pid" value="${
                                  data["product_id"][0]
                                }"/>
                                <input type="checkbox" class="productCheckbox" data-product-id="${
                                  data["product_id"][0]
                                }" name="" id="">
                            <img  alt="" class="img-fluid">
                            </div>
                            <div class="right col-lg-6 col-md-9 col-7">
                                <h4>${data["name_short"]}</h4>
                                <span>250kg</span>
                            </div>
                        </td>
                        <td>
                            <input type="number" class="quantity"  value="${
                              data["product_uom_qty"]
                            }">
                        </td>
                        <td>
                            <h4>${
                              data["price_unit"] *
                              data["product_uom_qty"]
                            } SR</h4>
                        </td>
                    </tr>
    `;
                        /////

                        cartContainer.innerHTML += cartHTML;

                        //////
                        console.log(productIds);
                        cartId = parseInt(data["order_id"][0]);
                        console.log(cartId);
                        subTotal += data["price_unit"] * data["product_uom_qty"];

                        console.log(data["name_short"]);
                        const deleteButton = document.getElementById("deleteButton");

                        //
                    });

                    document.getElementById("subTotal").innerHTML = subTotal + " SR";
                    document.getElementById("grandTotal").innerHTML = subTotal + " SR";
                    return true;
                })
                .then(() => {
                    deleteButton.addEventListener("click", function() {
                        // alert('Helo World');
                        let checkboxes = cartContainer.querySelectorAll('tbody > tr > td > .left > .productCheckbox');
                        let ids = [];
                        checkboxes.forEach(box => {
                            if (box.checked) {
                                ids.push(box.getAttribute('data-product-id'));
                            }
                        });
                        // Assuming 'cartId' and 'productIds' are available in this scope
                        del(cartId, ids);
                    });
                })
                .catch(function(error) {
                    console.error("Fetch error:", error);
                });

        }
        getCartContent();
        // Update the cart display


        function updateCartDisplay() {
            // var cartContainer = document.getElementById('cart');
            // cartContainer.innerHTML = '';
            // cart.forEach(function (item) {
            //     var itemElement = document.createElement('div');
            //     itemElement.textContent = `${item.productName} x${item.quantity} - $${item.price}`;
            //     cartContainer.appendChild(itemElement);
            // });
        }
    </script>
    <script src="js/jquery-3.3.1.min.js"></script>
    <script src="js/jquery.fancybox.min.js"></script>
    <script src="js/popper-min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/owl.carousel.min.js"></script>
    <script src="js/custom.js"></script>
    <script src="js/all.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.js"></script>
    <script>
        $('.slider-for').slick({
            slidesToShow: 1,
            slidesToScroll: 1,
            arrows: false,
            loop: true,
            fade: true,
            asNavFor: '.slider-nav'
        });
        $('.slider-nav').slick({
            slidesToShow: 3,
            slidesToScroll: 1,
            asNavFor: '.slider-for',
            dots: false,
            loop: true,
            arrows: false,
            centerMode: false,
            focusOnSelect: true
        });
    </script>
    <script>
        $('.equipment').owlCarousel({
            loop: true,
            margin: 10,
            nav: true,
            dots: true,
            responsive: {
                0: {
                    items: 1
                },
                600: {
                    items: 3
                },
                1000: {
                    items: 4
                }
            }
        });
        $('.beverage').owlCarousel({
            loop: true,
            margin: 10,
            nav: false,
            dots: true,
            responsive: {
                0: {
                    items: 1
                },
                600: {
                    items: 3
                },
                1000: {
                    items: 5
                }
            }
        });
    </script>
    <script>
        $(document).ready(function() {

            var quantitiy = 0;
            $('.quantity-right-plus').click(function(e) {

                // Stop acting like a button
                e.preventDefault();
                // Get the field name
                var quantity = parseInt($('#quantity').val());

                // If is not undefined

                $('#quantity').val(quantity + 1);


                // Increment

            });

            $('.quantity-left-minus').click(function(e) {
                // Stop acting like a button
                e.preventDefault();
                // Get the field name
                var quantity = parseInt($('#quantity').val());

                // If is not undefined

                // Increment
                if (quantity > 0) {
                    $('#quantity').val(quantity - 1);
                }
            });

            setTimeout(() => {

                // alert($('.VIpgJd-ZVi9od-l4eHX-hSRGPd').parent().parent().replace('Powered by ,',''));

                $('.VIpgJd-ZVi9od-l4eHX-hSRGPd').parent().remove();


                $(".goog-te-combo option").each(function() {

                    console.log($(this).val())
                        // Add $(this).val() to your list
                });





            }, 500);



        });
    </script>
</body>

</html>